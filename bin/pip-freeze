#!/usr/bin/env bash

SOURCEDIR="${1}"

if [ ! -d ${SOURCEDIR} ]; then
  echo "No such directory: ${SOURCEDIR}" >&2
  exit 1
fi

if [ -d .venv-tmp ]; then
  rm -fr .venv-tmp
fi

virtualenv .venv-tmp && \
  . .venv-tmp/bin/activate && \
  pip install -r "${SOURCEDIR}/requirements-.txt" && \
  pip freeze > "${SOURCEDIR}/requirements.txt" && \
  deactivate  && \
  rm -fr .venv-tmp


